# 제 5장. HTTP 와 연계하는 웹 서버
## 5.1. 1대로 멀티 도메인을 가능하게 하는 가상 호스트
- HTTP/1.1 에서는 하나의 서버에 여러개의 웹 사이트를 실행할수 있다.
  - ex) 웹 호스팅을 제공하고 있는 사업자
  - 이를 위해 ``가상호스트` 라는 기능을 사용하고 있다.
- 가상호스트를 사용하면 **물리적으로는 서버가 1대지만 가상으로 여러대가 있는 것처럼 설정하는 것이 가능**하다.
- 인터넷에서 도메인명은 DNS에 의해 IP 주소로 변환되고 나서 액세스한다. <br>결국 요청이 서버에 도착하는 시점에는 IP주소를 기준으로 접근하게 된다.
- 이때 가상호스트를 사용하고 있다면, 1대의 물리적 서버 에서 두개의 도메인이 있을경우 서버는 어느 쪽에 대한 접근인지 알 수가 없다.
  - 같은 서버 상에, 같은 IP 주소의 웹 서버에서 2개의 도메인이 실행되고 있을 때 DNS로 이름을 해결할 수 없다.
- HTTP 요청시에 **호스트명과 도메인명을 완전하게 포함한 URI를 지정**하거나, 반드시 Host 헤더필드에서 지정해야한다.
![](image.png)

## 5.2. 통신을 중계하는 프로그램 : 프록시, 게이트웨이, 터널
- HTTP는 클라이언트와 서버 이외에 프록시, 게이트웨이, 터널과 같은 통신을 중계하는 프로그램과 서버를 연계하는 것도 가능하다
- 프록시
  - 서버와 클라이언트의 양쪽 역할을 하는 중계 프로그램
  - 클라이언트 요청을 서버에 전송하고, 서버의 응답을 클라이언트에 전송한다
- 게이트웨이
  - 다른 서버를 중계하는 서버
  - 클라이언트로부터 수신한 요청을 리소스를 보유한 서버인 것처럼 수신한다
- 터널
  - 서로 떨어진 2대의 클라이언트와 서버 사이를 중계하며 접속을 주선하는 중계 프로그램

### 5.2.1. 프록시
- 프록시 서버의 기본 동작은 클라이언트로부터 받은 요청을 다른 서버에 전송하는 것이다
- 오리진 서버 : 리소스 본체를 가진 서버
- HTTP 통신을 할 때, 프록시 서버를 여러 대 경유하는 것도 가능하다
  - **중계할 때에는 Via 헤더필드에 경유한 호스트 정보를 추가**해야 한다
- 프록시 서버를 사용하는 이유
  - 캐시를 사용한 네트워크 대역을 효율적으로 사용하는 것
  - 조직 내에서 특정 웹사이트에 대한 접근제한
  - 액세스 로그를 획득하는 정책을 철저하게 관리하는 목적
- 캐싱 프록시 (Cashing Proxy)
  - 프록시로 응답을 중계할때는 **프록시 서버상에 리소스 캐시를 보존해두는 타입의 프록시**
  - 프록시에 같은 리소스에 요청이 온경우, 오리진 서버로 부터 리소스를 획득하는 것이 아닌 프록시 서버의 캐시를 응답으로 되돌려준다
- 투명 프록시 (Transparent Proxy)
  - 프록시로 요청과 응답을 중계할때 메세지 변경을 하지 않는 타입
  - 반대로 메세지에 변경을 주는 타입을 비투과 프록시라고 한다