# 7장. 웹을 안전하게 지켜주는 HTTPS

## 7.1 HTTP의 약점
- 평문(암호화하지 않은) 통신이기 때문에 도청 가능
- 통신 상대를 확인하지 않기 때문에 위장 가능
- 완전성을 증명할 수 없기 때문에 변조 가능

### 7.1.1 평문이기 때문에 도청 가능
#### TCP/IP는 도청 가능한 네트워크
  - TCP/IP의 구조의 통신 내용은 전부 통신 경로 도중에 엿볼 수 있다. 인터넷은 모든 곳에서 통신 내용이 도청될 가능성이 있다.
  - 암호화 통신은 메시지 속의 의미는 간파할 수 없을 수도 있겠지만 암호화된 메시지 자체는 엿볼 수 있다.
  - 네트워크 상을 흐르고 있는 패킷을 수집하는 것만으로도 도청 가능 (ex.Wireshark를 이용해 패킷 캡처)
#### 암호화로 도청을 피하다
암호화에는 몇 가지의 대상이 있다.


**1) 통신 암호화**
- HTTP에는 암호화 구조는 없지만 SSL이나 TLS라는 다른 프로토콜을 조합함으로써 통신 내용 암호화 가능
- SSL 등을 이용해 안전한 통신로를 확립하고 나서 그 통신로를 사용해 HTTP 통신을 한다.
- SSL을 조합한 HTTP를 HTTPS(HTTP Secure)나 HTTP over SSL이라 불리고 있음.


**2) 콘텐츠 암호화**
- 통신하는 콘텐츠의 내용 자체를 암호화
- HTTP를 사용해서 운반하는 내용을 암호화
- 이 경우, 클라이언트에서 HTTP 메시지를 암호화해서 출력하는 처리 필요
- 클라이언트와 서버가 콘텐츠의 암호화나 복호화 구조를 갖고 있는 것이 전제가 된다.

### 7.1.2 통신 상대를 확인하지 않기 때문에 위장 가능
- HTTP를 사용한 리퀘스트나 리스폰스에서는 통신 상대를 확인하지 않음.

#### 누구나 리퀘스트할 수 있다
- HTTP에 의한 통신에는 상대가 누구인지 확인하는 처리는 없다 ➡️ 누구든지 리퀘스트를 보낼 수 있다.
- 리퀘스트가 오면 상대가 누구든지 무언가의 리스폰스 반환(IP주소나 포트 등에서 그 웹서버에 액세스 제한이 없느 경우)
- 이 점이 약점이 될 수 있음
  - 위장한 웹 서버일 수 있다.
  - 위장한 클라이언트일 수 있다.
  - 통신하고 있는 상대가 접근이 허가된 상대인지 아닌지를 확인할 수 없다.
  - 어디의 누가 리퀘스트 했는지를 확인할 수 없다.
  - 의미없는 리퀘스트라도 수신하게 된다. DoS 공격을 방지할 수 없다.

#### 상대를 확인하는 증명서
- SSL은 암호화 뿐만 아니라 상대를 확인하는 수단으로 증명서 제공
- 증명서는 신뢰할 수 있는 제3자 기관에 의해 발행되는 것이기 때문에 서버나 클라이언트가 실재하는 사실을 증명한다.
- 이 증명서를 이용해 통신 상대가 내가 통신하고자 하는 서버임을 나타냄
- 또한, 클라이언트가 증명서를 가짐으로써 본인확인을 하고, 웹 사이트 인증에서 이용 가능

### 7.1.3 완전성을 증명할 수 없기 때문에 변조 가능
- **완전성** : 정보의 정확성
  - 이것을 증명할 수 없다는 것은 **정보가 정확한지 아닌지를 확인할 수 없다**는 의미
 
#### 수신한 내용이 다를지도 모른다
- 리퀘스트나 리스폰스가 발신되고 상대가 수신할 때까지의 사이에 변조되었더라도 이 사실을 알 수 없다.
  ➡️ 발신된 리퀘스트나 리스폰스와 수신한 리퀘스트나 리스폰스가 같은지 아닌지를 확인할 수 없다.
- 공격자가 도중에 리퀘스트나 리스폰스를 빼앗아 변조하는 공격 : 중간자 공격

#### 변조를 방지하려면?
- 확실하면서 편리한 방법은 현재로서는 존재하지 않음.
- 그 중에서도 자주 사용되는 방법은 MD5나 SHA-1 등의 **해시 값을 확인**하는 방법과 **파일의 디지털 서명을 확인하는 방법**
> 파일 다운로드 서비스를 제공하고 있는 웹 사이트에서는 PGP(Pretty Good Privacy)에 의한 서명과 MD5에 의한 해시 값을 제공하는 일이 있다. PGP는 파일을 작성했다는 증명을 위한 서명으로, MD5는 단방향성 함수에 의한 해시값이다.

- 확실히 방지하기에는 HTTPS를 사용할 필요가 있다.

## 7.2 HTTP + 암호화 + 인증 + 완전성 보호 = HTTPS

### 7.2.1 HTTP에 암호화와 인증과 완전성 보호를 더한 HTTPS
- HTTP에는 통신 상대의 서버나 클라이언트를 인증하는 수단이 없다.
- HTTP에 암호화나 인증 등의 구조를 더한 것이 HTTPS(HTTP Secure)

### 7.2.2 HTTPS는 SSL의 껍질을 덮어쓴 HTTP
- HTTPS는 새로운 애플리케이션 계층의 프로토콜은 아니다.
- HTTP 통신을 하는 소켓 부분을 SSL이나 TLS라는 프로토콜로 대체하고 있을 뿐
- 보통 HTTP는 TCP와 통신하지만 SSL을 사용한 경우에는 HTTPS는 SSL과 통신하고 SSL이 TCP와 통신하게 된다.
- SSL은 HTTP와는 독립된 프로토콜


![](https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSSTRXywQKcRMT7B6XqMC1AMWmDHX-MK_H1vw&s)
