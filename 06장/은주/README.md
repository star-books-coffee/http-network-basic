# 제 6장. HTTP 헤더
## 6.7. 쿠키를 위한 헤더 필드
- 쿠키는 유저 식별과 상태관리에 사용되고 있는 기능
  - 웹사이트가 유저 상태를 관리하기 위해, 웹 브라우저 경유로 유저의 컴퓨터 상에 **일시적으로 데이터를 기록해**둔다.
  - 다음에 그 유저가 웹 사이트에 액세스 했을 때 **지난번에 발행한 쿠키를 송신**받을 수 있다
- 쿠키가 호출되었을 때, **쿠키의 유효 기한, 송신지의 도메인, 경로, 프로토콜 등을 체크하는 것이 가능**하기에 적절하게 발행된 쿠키는 다른 웹사이트와 공격에 의해 데이터가 도난당할 일은 없다.

### 6.7.1. Set-Cookie
```http
Set-Cookie: status-enable' expires=Tue, 05 Jul 2011 07:25:31 GMT;=>path=/;domain=.hack.jp;
```
- Set-Cookie는 HTTP 응답 헤더에서 **서버가 클라이언트 측에 쿠키를 전송하기 위해 사용**됨
- Set-Cookie 필드의 속성
  - NAME=VALUE: 쿠키에 부여된 이름과 값(필수)
  - Expires=DATE: 쿠키 유효 기한(지정되지 않은 경우, 브라우저를 닫을 때까지 유효)
  - Path=PATH: 쿠키 적용 대상이 되는 서버 상의 디렉토리(지정하지 않은 경우, 도큐먼트와 같은 디렉토리)
  - Domain=도메인명: 쿠키 적용 대상이 되는 도메인 명(지정하지 않은 경우, 쿠키를 생성한 서버의 도메인)
  - Secure: HTTPS로 통신하고 있는 경우에만 쿠키를 송신
  - HttpOnly: 쿠키를 JavaScript에서 액세스하지 못하도록 제한

#### 1) Expires 속성
- 브라우저가 쿠키를 송출할 수 있는 유효기간 지정
- 속성을 생략한 경우 **브라우저 세션이 유지되는 동안만 유효하며, 통상적으로 브라우저 어플리케이션을 닫을 때까지** 유지됨

#### 2) Path 속성

#### 3) Domain 속성
- 명시적으로 여러 도메인에 대해 쿠키를 송출하는 경우를 제외하고, domain 속성은 지정하지 않는 쪽이 안전

#### 4) Secure 속성
- 웹 페이지가 **HTTPS 에서 열렸을 때만 쿠키 송출을 제한**하기 위해서 지정
```http
Set-Cookie: name=value; secure
```

#### 5) HttpOnly 속성
- 자바스크립트를 경유해서 쿠키를 취득하지 못하도록 하는 쿠키의 확장 기능
  - Javascript의 [document.cookie] 에서는 읽어들일 수 없음
  - 따라서 XSS 에서 Javascript 를 이용해 쿠키를 훔칠 수 없음

### 6.7.2. Cookie
```http
Cookie: status=enable
```
- 클라이언트가 HTTP의 상태 관리 지원을 원할 때 **서버로부터 수신한 쿠키를 이후의 리퀘스트에 포함해서 전달**한다

- 클라이언트가 서버에게 페이지 정보 요청
- 서버는 클라이언트에 대한 쿠키 생성, HTTP 응답 헤더에 쿠키를 포함하여 응답 (set-cookie)
- 클라이언트의 요청과 서버의 응답이 끝나면 HTTP 비연결성으로 인해 연결 끊김
- 새로운 요청 시, 이전에 받은 쿠키값을 보관하고 있다가 HTTP 요청 헤더에 값을 포함하여 요청 (cookie)
- 서버는 쿠키 값을 보고 이전에 요청 보낸 클라이언트를 인식하여 상태 기억하여 http 의 stateless 한 성질을 보완