# 8장. 누가 액세스하고 있는지를 확인하는 인증

## 8.1 인증이란?
- 본인인지 아닌지 확인하기 위해서는 [등록된 본인만 알고 있는 정보]나 [등록한 본인만이 가지고 있는 정보] 등으로 확인할 필요가 있다.
- 이러한 정보에는 주로 다음과 같은 것들 사용
  - 패스워드
  - 원타임 토큰 : 본인만이 가지고 있는 기기에 표시되는 한 번 쓰고 버리는 패스워드 등의 정보
  - 전자 증명서 : 본인(단말기)만이 가지고 있는 정보
  - 바이오 매트릭스 : 지문이나 홍채 등 신체 정보
  - IC 카드 등


### HTTP에서 사용하는 인증 방법
- BASIC 인증
- DIGEST 인증
- SSL 클라이언트 인증
- 폼 베이스 인증

## 8.2 BASIC 인증
- HTTP/1.0에 구현된 인증 방식으로 현재에도 일부 사용
- 웹 서버와 대응하고 있는 클라이언트 사이에서 이뤄지는 인증 방식

### 8.2.1 BASIC 인증 수순

1. 클라이언트 : 리퀘스트 송신
2. 서버 : 상태 코드 401로 응답해서 인증이 필요하다는 것을 전달
3. 클라이언트 : 유저 ID와 패스워드를 Base64 형식으로 인코드한 것을 송신
4. 서버 : 인증 성공 시에는 상태 코드 200으로 응답하고, 실패했을 경우에는 다시 상태 코드 401로 응답

- BASIC 인증에서는 Base64라는 인코딩 형식을 사용하고 있지만 이것은 암호화는 아니기 때문에 아무런 부가 정보 없이도 복호화할 수 있다.
- 한 번 BASIC 인증을 하면, 일반 브라우저에서는 로그아웃할 수 없다.

➡️ 그다지 사용되고 있지는 않다.

## 8.3 DIGEST 인증
- BASIC 인증의 약점을 보완하며 HTTP/1.1에 소개
- 챌린지 리스폰스 방식 사용 ➡️ 패스워드를 있는 그대로 직접 보내는 일은 없다.
- 챌린지 리스폰스 방식 : 상대방에게 인증 요구를 보내고 상대방 측에서 받은 챌린지 코드를 사용해서 리스폰스 코드를 계산
- 이 값을 상대에게 송신하여 인증
- BASIC 인증에 비해 패스워드 누출 가능성 줄어듦

### 8.3.1 DIGEST 인증 수순

1. 클라이언트 : 리퀘스트 송신
2. 서버 : 인증이 필요하다는 것을 전달하는 상태 코드 401로 응답하는 것과 함께 패스워드와 챌린지 코드 (nonce) 송신
3. 클라이언트 : 패스워드와 챌린지 코드에서 리스폰스 코드(response)를 계산해서 송신
4. 서버 : 인증 성공 시에는 상태 코드 200으로 응답하고, 실패했을 경우에는 다시 상태 코드 401로 응답

- HTTPS 클라이언트 인증 등에 비교하면 보안 등급이 낮음
- 위장을 방지하는 기능은 제공하고 있지 않음

➡️ 그다지 사용되고 있지는 않다.

## 8.4 SSL 클라이언트 인증
- ID와 패스워드가 도난되었을 경우에는 제 3자가 **위장**을 하는 경우가 있음.
- 이를 방지하기 위한 대책 중 하나로 SSL 클라이언트 인증 사용
- SSL 클라이언트 인증은 HTTPS의 클라이언트 인증서를 이용한 인증 방식


### 8.4.1 SSL 클라이언트 인증의 인증 수순
- 사전에 클라이언트에 클라이언트 증명서를 배포하고 인스톨 해둘 필요가 있음.

1. 서버는 클라이언트에게 클라이언트 증명서를 요구하는 "Certificate Request"라는 메시지 송신
2. 유저는 송신하는 클라이언트 증명서 선택
3. 서버는 클라이언트 증명서를 검증하여 결과가 정확하다면 클라이언트의 공개키 취득. 그 이후 HTTPS에 의한 암호 개시

### 8.4.2 SSL 클라이언트 인증은 2-factor 인증에서 사용된다
- SSL 클라이언트 인증은 대부분 단독으로 사용되지는 않고, 폼 베이스 인증과 합쳐서 2-factor 인증의 하나로서 이용되고 있음.
- 2-factor 인증 : 한 가지 요소만이 아닌 이용자가 가진 다른 정보를 병용해서 인증하는 방법

### 8.4.3 SSL 클라이언트 인증은 이용하는데 비용이 필요하다
- 클라이언트 증명서의 비용은 인증 기관에 의해서 다르지만 증명서 한 개당 연간 수만 원에서 수백만 원 정도

## 8.5 폼 베이스 인증
- HTTP 프로토콜로서 사양이 정의되어 있는 인증 방식은 아니다.
- 클라이언트가 서버 상의 웹 애플리케이션에 자격 정보를 송신하여 그 자격 정보의 검증 결과에 따라 인증을 하는 방식
- 대부분의 경우 사전에 등록해둔 자격 정보인 유저 ID와 패스워드를 입력해 이것을 웹 애플리케이션 측에 송신하고 검증 결과를 토대로 검증 성공 여부 결정

### 8.5.1 인증의 대부분은 폼 베이스 인증
- 웹 사이트의 인증 기능으로서 요구되는 기능의 레벨을 충족시킨 표준적인 것이 존재하지 않기 때문에 웹 애플리케이션에거 제각각 구현하는 폼 베이스 인증을 채용
- 폼 베이스 인증에서는 웹 사이트 별로 다르게 구현
- 자주 사용되고 있는 방법은 세션 관리를 위해 쿠키를 사용하는 방법
- 폼 베이스 인증에서는 자격 정보를 교환하는 방법은 표준화되어 있지 않을 뿐만 아니라 패스워드 등의 자격 정보를 서버 측에 어떻게 보존해야 하는지도 표준화되어 있지 않다.
- 일반적으로는 안전한 방법으로서 패스워드를 salt라는 부가 정보를 사용해서 해시라는 알고리즘으로 계산한 값을 저장
